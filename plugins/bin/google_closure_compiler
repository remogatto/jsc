#!/usr/bin/env ruby

require File.expand_path(
    File.join(File.dirname(__FILE__), %w[.. .. lib google_closure_compiler]))

# Just for sample, read file and compile it!
code_to_compile, result = ClosureCompiler.read_file('js/compiled_code.js')
if result
  compiled_code = ClosureCompiler.compile(code_to_compile, "compiled_code")
  unless compiled_code.nil?
    puts compiled_code
  end
else
    puts "ERROR reading file\n"
end
puts "**************\n"

# Compile a whole directory
js_dir = "js" # relative path to js directory
puts "Compiling a WHOLE directory...\n"
puts ClosureCompiler.compile_dir(js_dir, "statistics")
puts "**************\n"

# Execute every check on the file
puts ClosureCompiler.compile_file("js/compiled_code.js", "compiled_code")
puts "*******************"
puts ClosureCompiler.compile_file("js/compiled_code.js", "warnings")
puts "*******************"
puts ClosureCompiler.compile_file("js/compiled_code.js", "errors")
puts "*******************"
puts ClosureCompiler.compile_file("js/compiled_code.js", "statistics")

# Give me statistics!
code_to_compile = "function hello(a){alert(\"Hello, \"+a)}hello(\"New user\");"
puts ClosureCompiler.compile(code_to_compile, "statistics")
puts "**************\n"
